# 国际化

Super Client R 支持多语言界面，可以轻松切换语言或添加新语言。

## 支持的语言

| 语言 | 代码 | 状态 |
|------|------|------|
| 简体中文 | zh-CN | ✅ 完整 |
| 英语 | en | ✅ 完整 |

## 切换语言

### 通过设置界面

```
设置 → 通用 → 语言
```

### 通过配置文件

```json
{
  "general": {
    "language": "en"
  }
}
```

## 语言文件结构

语言文件位于 `src/renderer/src/i18n/locales/`：

```
i18n/locales/
├── en/
│   ├── common.json
│   ├── chat.json
│   ├── settings.json
│   └── mcp.json
└── zh/
    ├── common.json
│   ├── chat.json
│   ├── settings.json
│   └── mcp.json
```

## 添加新语言

### 1. 创建语言文件

在 `src/renderer/src/i18n/locales/` 下创建新语言目录：

```bash
mkdir -p src/renderer/src/i18n/locales/fr
```

### 2. 复制并翻译

复制英语文件作为模板：

```bash
cp src/renderer/src/i18n/locales/en/*.json \
   src/renderer/src/i18n/locales/fr/
```

### 3. 翻译内容

编辑 JSON 文件，翻译所有字符串：

```json
// fr/common.json
{
  "app": {
    "name": "Super Client R",
    "tagline": "Client de bureau IA"
  },
  "nav": {
    "chat": "Chat",
    "mcp": "MCP",
    "skills": "Compétences",
    "settings": "Paramètres"
  },
  "actions": {
    "send": "Envoyer",
    "cancel": "Annuler",
    "save": "Enregistrer",
    "delete": "Supprimer"
  }
}
```

### 4. 注册语言

在 `src/renderer/src/i18n/index.ts` 中添加：

```typescript
import frCommon from './locales/fr/common.json';
import frChat from './locales/fr/chat.json';

const resources = {
  en: { ... },
  zh: { ... },
  fr: {
    common: frCommon,
    chat: frChat,
    // ...
  }
};

i18n.use(initReactI18next).init({
  resources,
  lng: 'zh',
  fallbackLng: 'en',
  // ...
});
```

### 5. 更新语言列表

在设置页面的语言选项中添加新语言：

```typescript
const languages = [
  { value: 'zh', label: '简体中文' },
  { value: 'en', label: 'English' },
  { value: 'fr', label: 'Français' },
];
```

## 使用翻译

### 在组件中

```tsx
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation('common');

  return (
    <button>{t('actions.send')}</button>
  );
}
```

### 带插值

```json
{
  "welcome": "Welcome, {{name}}!",
  "messages": "You have {{count}} new messages"
}
```

```tsx
const { t } = useTranslation();

<p>{t('welcome', { name: 'John' })}</p>
<p>{t('messages', { count: 5 })}</p>
```

### 复数形式

```json
{
  "message": "One message",
  "message_plural": "{{count}} messages"
}
```

```tsx
<p>{t('message', { count: 5 })}</p>
```

### 命名空间

```tsx
// 使用多个命名空间
const { t } = useTranslation(['common', 'chat']);

t('common:actions.send');
t('chat:placeholder');
```

## 翻译规范

### 命名约定

```
common:    # 通用翻译
  app.*    # 应用相关
  nav.*    # 导航
  actions.* # 操作按钮

chat:      # 聊天页面
  placeholder
  send
  thinking

settings:  # 设置页面
  general
  models
  mcp
```

### 格式规范

1. **使用小写键名**：`sendMessage` 而非 `SendMessage`
2. **分层组织**：`actions.send` 而非 `sendAction`
3. **避免硬编码**：所有用户可见文本都要翻译
4. **保持一致性**：相同概念使用相同翻译

### 示例

```json
{
  "chat": {
    "title": "AI Chat",
    "placeholder": "Type your message...",
    "send": "Send",
    "thinking": "Thinking...",
    "error": {
      "network": "Network error, please try again",
      "api": "API error: {{message}}"
    }
  }
}
```

## 自动翻译脚本

项目提供了自动翻译脚本：

```bash
# 检查翻译完整性
pnpm i18n:check

# 自动翻译缺失的键（需要配置 API Key）
pnpm i18n:translate
```

### 配置翻译 API

在 `.env` 中添加：

```bash
TRANSLATION_API_KEY=your-key
TRANSLATION_PROVIDER=openai  # 或 google, azure
```

## 贡献翻译

欢迎贡献新的语言支持！

### 步骤

1. Fork 项目
2. 创建语言分支：`git checkout -b add-language-fr`
3. 添加翻译文件
4. 运行检查：`pnpm i18n:check`
5. 提交 PR

### 质量要求

- 所有键必须翻译
- 保持术语一致性
- 符合目标语言习惯
- 测试界面显示效果

## 故障排除

### 翻译不显示

1. 检查语言文件路径
2. 验证 JSON 格式
3. 确认语言已注册

### 键未找到

```tsx
// 使用 fallback
const { t } = useTranslation();
t('key', { defaultValue: 'Default Text' });
```

### 格式错误

确保插值变量正确：

```json
{
  "greeting": "Hello {{name}}"  // ✅ 正确
  "greeting": "Hello {name}"    // ❌ 错误
}
```
