AI 技术规范

一、技术栈要求

1. 前端技术栈：采用 React 作为前端框架，搭配 TypeScript 保障类型安全；构建工具使用 Vite7 + Rolldown，提升构建效率与打包性能；UI 组件库选用 Ant Design（antd），确保界面风格统一、交互体验规范。

2. 包管理工具：统一使用 pnpm 进行依赖管理，需锁定依赖版本（通过 pnpm-lock.yaml），避免因依赖差异导致的环境问题，同时遵循 pnpm 规范执行安装、构建、运行命令。

3. 后端与运行时：后端采用 Node.js 作为运行环境，负责接口开发、服务调度等功能；AI 相关脚本运行及工具调用统一使用 Bun，替代传统 Node 脚本执行，提升运行速度。

4. Python 环境管理：使用 pyenv 管理 Python 版本，确保开发、测试、生产环境的 Python 版本一致，避免版本兼容问题，搭配虚拟环境隔离项目依赖。

5. 技术栈一致性：所有开发人员需严格遵循上述技术栈，禁止擅自引入其他替代技术；若因业务需求需新增技术，需经过团队评审通过后，更新本规范并同步至全员。

二、架构规范

1. 分层设计：AI 模块需遵循分层架构，明确区分数据层、模型层、服务层、应用层，各层职责边界清晰，禁止跨层直接调用。数据层负责数据存储与预处理，模型层负责模型训练、推理与管理，服务层负责接口封装与调度，应用层负责业务落地适配。

2. 模块解耦：核心组件（如数据处理模块、模型推理模块、交互模块）需实现低耦合、高内聚，通过标准化接口通信，支持独立部署、升级与替换，避免模块间强依赖导致的维护困难。

3. 可扩展性：架构设计需预留扩展空间，支持新增模型、数据源及业务场景，兼容不同类型的 AI 模型（如大语言模型、机器学习模型），同时适配单机、分布式部署模式。

4. 兼容性：需兼容现有系统技术栈，AI 模块与非 AI 模块的交互需遵循统一的协议规范，确保系统整体兼容性与稳定性。

三、代码质量规范

1. 编码标准：遵循对应编程语言的官方编码规范（如 Python PEP 8、Java Alibaba 开发手册），命名规范统一（类名 PascalCase、方法名与变量名 camelCase、常量全大写下划线分隔），代码缩进、注释格式一致。

2. 注释要求：核心代码（如模型推理逻辑、数据处理算法、关键工具类）需添加详细注释，包括功能描述、参数说明、返回值含义、异常场景说明；复杂算法需补充逻辑流程图或文字说明，确保可读性。

3. 代码复用：提炼通用功能为工具类或公共方法，避免重复编码；禁止复制粘贴代码片段，同类业务逻辑需抽象统一实现，提升代码复用率与可维护性。

4. 异常处理：完善异常捕获与处理机制，针对 AI 场景常见异常（如模型加载失败、数据格式错误、推理超时）进行针对性处理，明确异常提示信息，避免程序崩溃，同时记录异常日志便于排查。

5. 单元测试：核心模块需编写单元测试用例，覆盖正常场景、异常场景及边界条件，测试覆盖率不低于 80%；模型相关代码需补充推理结果验证用例，确保输出符合预期。

四、性能优化规范

1. 模型性能：训练阶段优化模型结构与超参数，避免过度拟合，提升模型泛化能力；推理阶段通过模型量化、剪枝、缓存等方式，降低推理延迟，确保接口响应时间满足业务要求（如实时场景延迟≤500ms）。

2. 数据处理性能：优化数据读取、清洗、转换逻辑，批量处理数据以提升效率；避免冗余数据处理步骤，合理使用缓存存储中间结果，减少重复计算。

3. 资源占用：控制 AI 模块的 CPU、内存、显存占用，避免资源泄露；分布式部署时合理分配资源，实现负载均衡，提升资源利用率。

4. 并发处理：服务层需支持高并发请求，通过线程池、异步处理等方式提升并发能力，同时做好限流、熔断机制，防止突发流量导致系统过载。

五、安全规范

1. 数据安全：训练数据与推理数据需进行脱敏处理，禁止存储敏感信息（如个人隐私、机密数据）；数据传输过程中采用加密协议（如 HTTPS、AES），防止数据泄露、篡改。

2. 模型安全：模型文件需进行加密存储与权限管控，禁止未授权访问、下载；模型部署时避免暴露核心参数，防止模型被攻击或窃取。

3. 接口安全：AI 服务接口需添加身份认证、权限校验机制，支持接口调用日志审计；针对恶意请求进行拦截与防护，防止接口被滥用或攻击。

4. 输出安全：对 AI 模型输出结果进行内容审核，过滤违法、违规、低俗内容，确保输出合规；针对生成式 AI，避免输出误导性信息。

六、文档规范

1. 设计文档：每个 AI 功能模块需编写设计文档，包括模块定位、架构设计、核心逻辑、接口定义、依赖关系、部署说明等，确保文档与代码一致。

2. 接口文档：AI 服务接口需提供标准化接口文档，明确请求参数、返回格式、异常码、调用示例等，支持自动生成与同步更新（如使用 Swagger）。

3. 模型文档：记录模型相关信息，包括模型类型、训练数据、超参数、性能指标、适用场景、局限性等，便于后续模型迭代与维护。

4. 运维文档：编写部署手册、运维手册，明确环境依赖、部署步骤、启停命令、故障排查方案、监控指标等，保障运维人员高效操作。

5. 版本文档：每个功能迭代需更新版本日志，记录功能变更、问题修复、性能优化等内容，格式统一、描述清晰。

七、提交（Commit）规范

1. 提交时机：每完成一个独立功能模块、修复一个 bug、优化一项性能或完善一份核心文档后，需单独提交一次，禁止多个功能合并为一个提交。

2. 提交信息格式：遵循固定格式：类型(范围): 描述信息

  - 类型：feat（新功能）、fix（bug 修复）、opt（性能优化）、docs（文档更新）、refactor（代码重构）、test（测试用例）、chore（构建/依赖调整）。

  - 范围：明确提交对应的模块（如 model、service、data、api）。

  - 描述信息：简洁明了，说明提交的核心内容，不超过 50 字，使用中文或英文均可（建议统一语言）。

3. 提交内容要求：提交内容需完整，仅包含当前功能相关的代码、文档、测试用例等文件，禁止提交冗余文件（如编译产物、临时文件）。

4. 提交前检查：提交前需自行检查代码是否符合编码规范、单元测试是否通过、功能是否正常运行、文档是否同步更新，避免提交有问题的代码。

5. 分支规范：基于开发分支（如 develop）创建特性分支（feat/xxx）或修复分支（fix/xxx），完成后提交至对应分支，通过审核后合并，禁止直接提交至主分支（main/master）。
